<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.13">
  <compounddef id="matrix__product__stl_8h" kind="file" language="C++">
    <compoundname>matrix_product_stl.h</compoundname>
    <includes refid="nmspc__eigutils_8h" local="no">math/nmspc_eigutils.h</includes>
    <includes refid="class__tic__toc_8h" local="no">general/class_tic_toc.h</includes>
    <includes local="no">iostream</includes>
    <includes local="no">iomanip</includes>
    <includes local="no">vector</includes>
    <includedby refid="arpackpp__solver_8cpp" local="yes">/home/david/Dropbox/PhD/Programming/DMRG++/DMRG++/source/math/arpack_extra/arpackpp_solver.cpp</includedby>
    <includedby refid="matrix__product__stl_8cpp" local="yes">/home/david/Dropbox/PhD/Programming/DMRG++/DMRG++/source/math/arpack_extra/matrix_product_stl.cpp</includedby>
    <includedby refid="ceres__subspace_8cpp" local="no">/home/david/Dropbox/PhD/Programming/DMRG++/DMRG++/source/tools/finite/opt-internals/ceres_subspace.cpp</includedby>
    <incdepgraph>
      <node id="1193">
        <label>iomanip</label>
      </node>
      <node id="1191">
        <label>general/class_tic_toc.h</label>
        <link refid="class__tic__toc_8h"/>
        <childnode refid="1192" relation="include">
        </childnode>
        <childnode refid="1184" relation="include">
        </childnode>
      </node>
      <node id="1186">
        <label>map</label>
      </node>
      <node id="1190">
        <label>spdlog/spdlog.h</label>
      </node>
      <node id="1182">
        <label>/home/david/Dropbox/PhD/Programming/DMRG++/DMRG++/source/math/arpack_extra/matrix_product_stl.h</label>
        <link refid="matrix__product__stl_8h"/>
        <childnode refid="1183" relation="include">
        </childnode>
        <childnode refid="1191" relation="include">
        </childnode>
        <childnode refid="1184" relation="include">
        </childnode>
        <childnode refid="1193" relation="include">
        </childnode>
        <childnode refid="1188" relation="include">
        </childnode>
      </node>
      <node id="1188">
        <label>vector</label>
      </node>
      <node id="1189">
        <label>spdlog/sinks/stdout_color_sinks.h</label>
      </node>
      <node id="1185">
        <label>array</label>
      </node>
      <node id="1184">
        <label>iostream</label>
      </node>
      <node id="1183">
        <label>math/nmspc_eigutils.h</label>
        <link refid="nmspc__eigutils_8h"/>
        <childnode refid="1184" relation="include">
        </childnode>
        <childnode refid="1185" relation="include">
        </childnode>
        <childnode refid="1186" relation="include">
        </childnode>
        <childnode refid="1187" relation="include">
        </childnode>
        <childnode refid="1188" relation="include">
        </childnode>
        <childnode refid="1189" relation="include">
        </childnode>
        <childnode refid="1190" relation="include">
        </childnode>
      </node>
      <node id="1192">
        <label>chrono</label>
      </node>
      <node id="1187">
        <label>complex</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="1195">
        <label>/home/david/Dropbox/PhD/Programming/DMRG++/DMRG++/source/math/arpack_extra/arpackpp_solver.cpp</label>
        <link refid="arpackpp__solver_8cpp"/>
      </node>
      <node id="1194">
        <label>/home/david/Dropbox/PhD/Programming/DMRG++/DMRG++/source/math/arpack_extra/matrix_product_stl.h</label>
        <link refid="matrix__product__stl_8h"/>
        <childnode refid="1195" relation="include">
        </childnode>
        <childnode refid="1196" relation="include">
        </childnode>
        <childnode refid="1197" relation="include">
        </childnode>
      </node>
      <node id="1197">
        <label>/home/david/Dropbox/PhD/Programming/DMRG++/DMRG++/source/tools/finite/opt-internals/ceres_subspace.cpp</label>
        <link refid="ceres__subspace_8cpp"/>
      </node>
      <node id="1196">
        <label>/home/david/Dropbox/PhD/Programming/DMRG++/DMRG++/source/math/arpack_extra/matrix_product_stl.cpp</label>
        <link refid="matrix__product__stl_8cpp"/>
      </node>
    </invincdepgraph>
    <innerclass refid="class_stl_matrix_product" prot="public">StlMatrixProduct</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="matrix__product__stl_8h_1afb69439b6c29dc85f40f2df36cf15d68" prot="public" static="no">
        <name>profile_matrix_product_dense</name>
        <initializer>1</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/david/Dropbox/PhD/Programming/DMRG++/DMRG++/source/math/arpack_extra/matrix_product_stl.h" line="16" column="14" bodyfile="/home/david/Dropbox/PhD/Programming/DMRG++/DMRG++/source/math/arpack_extra/matrix_product_stl.h" bodystart="16" bodyend="-1"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Created<sp/>by<sp/>david<sp/>on<sp/>2018-11-16.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>MATRIX_PRODUCT_STL_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>MATRIX_PRODUCT_STL_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="nmspc__eigutils_8h" kindref="compound">math/nmspc_eigutils.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="class__tic__toc_8h" kindref="compound">general/class_tic_toc.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;iostream&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;iomanip&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;vector&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16" refid="matrix__product__stl_8h_1afb69439b6c29dc85f40f2df36cf15d68" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>profile_matrix_product_dense<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>Scalar_&gt;</highlight></codeline>
<codeline lineno="20" refid="class_stl_matrix_product" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="class_stl_matrix_product" kindref="compound">StlMatrixProduct</ref><sp/>{</highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="22" refid="class_stl_matrix_product_1a76ab9cc7da91d13ffa17e3e4bf0d5f34" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a76ab9cc7da91d13ffa17e3e4bf0d5f34" kindref="member">Scalar</ref><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>Scalar_;</highlight></codeline>
<codeline lineno="23" refid="class_stl_matrix_product_1ac2438101eca4772ce8e979ab8270e722" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>constexpr<sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><sp/><ref refid="class_stl_matrix_product_1ac2438101eca4772ce8e979ab8270e722" kindref="member">can_shift</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26" refid="class_stl_matrix_product_1a5e33d520e1c62efd4c36af977776d712" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::vector&lt;Scalar&gt;<sp/><ref refid="class_stl_matrix_product_1a5e33d520e1c62efd4c36af977776d712" kindref="member">A_stl</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>actual<sp/>matrix.<sp/>Given<sp/>matrices<sp/>will<sp/>be<sp/>copied<sp/>into<sp/>this<sp/>one.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27" refid="class_stl_matrix_product_1a42e15800d20b2f825a24c4404ee51bf6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a76ab9cc7da91d13ffa17e3e4bf0d5f34" kindref="member">Scalar</ref><sp/>*<ref refid="class_stl_matrix_product_1a42e15800d20b2f825a24c4404ee51bf6" kindref="member">A_ptr</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>A<sp/>pointer<sp/>to<sp/>the<sp/>matrix,<sp/>to<sp/>allow<sp/>optional<sp/>copying<sp/>of<sp/>the<sp/>matrix.<sp/>Note<sp/>that<sp/>PartialPivLU<sp/>stores<sp/>LU<sp/>in<sp/>A.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28" refid="class_stl_matrix_product_1aaa88495509aa660cd6ca840a8bbf22fa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1aaa88495509aa660cd6ca840a8bbf22fa" kindref="member">L</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>linear<sp/>matrix<sp/>dimension</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29" refid="class_stl_matrix_product_1a22eeead3b123a946a2c298b1afe31260" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespaceeigutils_1_1eig_setting_1ab3540d4cdfdd84861825cc2a89135306" kindref="member">eigutils::eigSetting::Form</ref><sp/><ref refid="class_stl_matrix_product_1a22eeead3b123a946a2c298b1afe31260" kindref="member">form</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Chooses<sp/>SYMMETRIC<sp/>/<sp/>NONSYMMETRIC<sp/>mode</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30" refid="class_stl_matrix_product_1add7f8456eb6a5f560f8c492860c427ae" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespaceeigutils_1_1eig_setting_1a7b4469c018633b8c2c2d596b5e38de74" kindref="member">eigutils::eigSetting::Side</ref><sp/><ref refid="class_stl_matrix_product_1add7f8456eb6a5f560f8c492860c427ae" kindref="member">side</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Chooses<sp/>whether<sp/>to<sp/>find<sp/>(R)ight<sp/>or<sp/>(L)eft<sp/>eigenvectors</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Shift-invert<sp/>mode<sp/>stuff</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33" refid="class_stl_matrix_product_1a355cc77be4cb62ef5895b7fcdd219e8c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a355cc77be4cb62ef5895b7fcdd219e8c" kindref="member">sigmaR</ref><sp/>=<sp/>0.0;<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>real<sp/>part<sp/>of<sp/>the<sp/>shift</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34" refid="class_stl_matrix_product_1a877daca2fe32ba08d4e5bdbf19f60e6e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a877daca2fe32ba08d4e5bdbf19f60e6e" kindref="member">sigmaI</ref><sp/>=<sp/>0.0;<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>imag<sp/>part<sp/>of<sp/>the<sp/>shift</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35" refid="class_stl_matrix_product_1a77fb74248a56296a3f6fbe592029a061" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a77fb74248a56296a3f6fbe592029a061" kindref="member">readyFactorOp</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Flag<sp/>to<sp/>make<sp/>sure<sp/>LU<sp/>factorization<sp/>has<sp/>occurred</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36" refid="class_stl_matrix_product_1ac028d93fec8df6157d25dc9753441876" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1ac028d93fec8df6157d25dc9753441876" kindref="member">readyShift</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Flag<sp/>to<sp/>make<sp/>sure</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Pointer<sp/>to<sp/>data<sp/>constructor,<sp/>copies<sp/>the<sp/>matrix<sp/>into<sp/>an<sp/>internal<sp/>Eigen<sp/>matrix.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40" refid="class_stl_matrix_product_1a89163543d448d6852c458eaeda139fcd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_stl_matrix_product_1a89163543d448d6852c458eaeda139fcd" kindref="member">StlMatrixProduct</ref>(</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a76ab9cc7da91d13ffa17e3e4bf0d5f34" kindref="member">Scalar</ref><sp/>*<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>A_,</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>L_,</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceeigutils_1_1eig_setting_1ab3540d4cdfdd84861825cc2a89135306" kindref="member">eigutils::eigSetting::Form</ref><sp/>form_<sp/>=<sp/><ref refid="namespaceeigutils_1_1eig_setting_1ab3540d4cdfdd84861825cc2a89135306a161b3d9016563aba9ac190fc02ada9bb" kindref="member">eigutils::eigSetting::Form::SYMMETRIC</ref>,</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceeigutils_1_1eig_setting_1a7b4469c018633b8c2c2d596b5e38de74" kindref="member">eigutils::eigSetting::Side</ref><sp/>side_<sp/>=<sp/><ref refid="namespaceeigutils_1_1eig_setting_1a7b4469c018633b8c2c2d596b5e38de74ae1e1d3d40573127e9ee0480caf1283d6" kindref="member">eigutils::eigSetting::Side::R</ref>,</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>copy_data<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/>):<sp/>A_ptr(A_)<sp/>,L(L_),<sp/>form(form_),<sp/>side(side_)</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(copy_data){</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A_stl.resize(L*L);</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::copy(A_ptr,A_ptr<sp/>+<sp/>L*L,<sp/>A_stl.begin());</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A_ptr<sp/>=<sp/>A_stl.data();</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_stl_matrix_product_1a0107c3412a6714e441b4d71b36116598" kindref="member">init_profiling</ref>();</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_stl_matrix_product_1a3d12eaf4c87fa24c74ed65e86b0b860e" kindref="member">~StlMatrixProduct</ref>();</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Functions<sp/>used<sp/>in<sp/>in<sp/>Arpack++<sp/>solver</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61" refid="class_stl_matrix_product_1a8fa9f6e3fc682948446bc13b10c903b5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a8fa9f6e3fc682948446bc13b10c903b5" kindref="member">rows</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1aaa88495509aa660cd6ca840a8bbf22fa" kindref="member">L</ref>;};</highlight></codeline>
<codeline lineno="62" refid="class_stl_matrix_product_1ad8bb923ac624a4ec7431995aa478ef80" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1ad8bb923ac624a4ec7431995aa478ef80" kindref="member">cols</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1aaa88495509aa660cd6ca840a8bbf22fa" kindref="member">L</ref>;};</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a9c648b3a4c73d93511dd3d7a8bec2630" kindref="member">FactorOP</ref>();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>Factors<sp/>(A-sigma*I)<sp/>into<sp/>PLU</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a44e185122b14fe0603ae8c1a00a9886c" kindref="member">MultOPv</ref>(<ref refid="class_stl_matrix_product_1a76ab9cc7da91d13ffa17e3e4bf0d5f34" kindref="member">Scalar</ref>*<sp/>x_in_ptr,<sp/><ref refid="class_stl_matrix_product_1a76ab9cc7da91d13ffa17e3e4bf0d5f34" kindref="member">Scalar</ref>*<sp/>x_out_ptr);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/>Computes<sp/>the<sp/>matrix-vector<sp/>product<sp/>x_out<sp/>&lt;-<sp/>inv(A-sigma*I)*x_in.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a5e01ae791681e6383cad617a87d2e9e8" kindref="member">MultAx</ref><sp/>(<ref refid="class_stl_matrix_product_1a76ab9cc7da91d13ffa17e3e4bf0d5f34" kindref="member">Scalar</ref>*<sp/>x_in_ptr,<sp/><ref refid="class_stl_matrix_product_1a76ab9cc7da91d13ffa17e3e4bf0d5f34" kindref="member">Scalar</ref>*<sp/>x_out_ptr);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/>Computes<sp/>the<sp/>matrix-vector<sp/>multiplication<sp/>x_out<sp/>&lt;-<sp/>A*x_in.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Various<sp/>utility<sp/>functions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68" refid="class_stl_matrix_product_1a8c6bddeab36cbdf2df7ffd7d39bf034a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a8c6bddeab36cbdf2df7ffd7d39bf034a" kindref="member">counter</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1af9f79876cd02cafe4e2badecfa1de022" kindref="member">print</ref>()</highlight><highlight class="keyword">const</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="70" refid="class_stl_matrix_product_1a9e4bb7514f7e50cef962ce232cf3728d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a9e4bb7514f7e50cef962ce232cf3728d" kindref="member">set_shift</ref>(std::complex&lt;double&gt;<sp/>sigma_)<sp/><sp/><sp/>{</highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(readyShift){</highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;}<sp/>sigmaR=std::real(sigma_);sigmaI=std::imag(sigma_)<sp/>;readyShift<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;}</highlight></codeline>
<codeline lineno="71" refid="class_stl_matrix_product_1abd57f95f23f637833fe0b640f847e19b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1abd57f95f23f637833fe0b640f847e19b" kindref="member">set_shift</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sigma_)<sp/><sp/><sp/>{</highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(readyShift){</highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;}<sp/>sigmaR=sigma_,<sp/>sigmaI<sp/>=<sp/>0.0;readyShift<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;}</highlight></codeline>
<codeline lineno="72" refid="class_stl_matrix_product_1a04718b5133a8823a3768225ed06b6410" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a04718b5133a8823a3768225ed06b6410" kindref="member">set_shift</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigmaR_,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigmaI_){</highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(readyShift){</highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;}<sp/>sigmaR=sigmaR_;sigmaI<sp/>=<sp/>sigmaI_<sp/>;readyShift<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;}</highlight></codeline>
<codeline lineno="73" refid="class_stl_matrix_product_1a551193db01e23ecb2a3e89c69f186534" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a551193db01e23ecb2a3e89c69f186534" kindref="member">set_mode</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceeigutils_1_1eig_setting_1ab3540d4cdfdd84861825cc2a89135306" kindref="member">eigutils::eigSetting::Form</ref><sp/>form_){form<sp/>=<sp/>form_;}</highlight></codeline>
<codeline lineno="74" refid="class_stl_matrix_product_1a921d8d3238fc8967c5030dd5a2282f9c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a921d8d3238fc8967c5030dd5a2282f9c" kindref="member">set_side</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceeigutils_1_1eig_setting_1a7b4469c018633b8c2c2d596b5e38de74" kindref="member">eigutils::eigSetting::Side</ref><sp/>side_){side<sp/>=<sp/>side_;}</highlight></codeline>
<codeline lineno="75" refid="class_stl_matrix_product_1a36df1fcd4ceb2fe4a15d341f680043b1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::vector&lt;Scalar&gt;<sp/><ref refid="class_stl_matrix_product_1a36df1fcd4ceb2fe4a15d341f680043b1" kindref="member">get_matrix</ref>()</highlight><highlight class="keyword">const</highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>std::vector&lt;Scalar&gt;(<ref refid="class_stl_matrix_product_1a42e15800d20b2f825a24c4404ee51bf6" kindref="member">A_ptr</ref>,A_ptr+L*<ref refid="class_stl_matrix_product_1aaa88495509aa660cd6ca840a8bbf22fa" kindref="member">L</ref>);}</highlight></codeline>
<codeline lineno="76" refid="class_stl_matrix_product_1a41b8578a26ceeb57efec55eb02b28c2e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceeigutils_1_1eig_setting_1ab3540d4cdfdd84861825cc2a89135306" kindref="member">eigutils::eigSetting::Form</ref><sp/>&amp;<ref refid="class_stl_matrix_product_1a41b8578a26ceeb57efec55eb02b28c2e" kindref="member">get_form</ref>()</highlight><highlight class="keyword">const</highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a22eeead3b123a946a2c298b1afe31260" kindref="member">form</ref>;}</highlight></codeline>
<codeline lineno="77" refid="class_stl_matrix_product_1aa6f773c8cee584d46d6c2fd01755e6e7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceeigutils_1_1eig_setting_1a7b4469c018633b8c2c2d596b5e38de74" kindref="member">eigutils::eigSetting::Side</ref><sp/>&amp;<ref refid="class_stl_matrix_product_1aa6f773c8cee584d46d6c2fd01755e6e7" kindref="member">get_side</ref>()</highlight><highlight class="keyword">const</highlight><highlight class="normal">{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1add7f8456eb6a5f560f8c492860c427ae" kindref="member">side</ref>;}</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Profiling</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80" refid="class_stl_matrix_product_1a0107c3412a6714e441b4d71b36116598" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_stl_matrix_product_1a0107c3412a6714e441b4d71b36116598" kindref="member">init_profiling</ref>(){</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_stl_matrix_product_1a6219be75e20d74386189487579c4b6c7" kindref="member">t_factorOp</ref>.<ref refid="classclass__tic__toc_1a235fdbf16b92fac52940f351d8459ab3" kindref="member">set_properties</ref>(<ref refid="matrix__product__stl_8h_1afb69439b6c29dc85f40f2df36cf15d68" kindref="member">profile_matrix_product_dense</ref>,<sp/>5,</highlight><highlight class="stringliteral">&quot;Time<sp/>FactorOp&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_stl_matrix_product_1af370a6db867ce36ca09b2953239b013b" kindref="member">t_multOpv</ref>.<ref refid="classclass__tic__toc_1a235fdbf16b92fac52940f351d8459ab3" kindref="member">set_properties</ref>(<ref refid="matrix__product__stl_8h_1afb69439b6c29dc85f40f2df36cf15d68" kindref="member">profile_matrix_product_dense</ref>,<sp/>5,</highlight><highlight class="stringliteral">&quot;Time<sp/>MultOpv&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_stl_matrix_product_1afd02aa86cc9ec8e94cffff6e33c659aa" kindref="member">t_multax</ref>.<ref refid="classclass__tic__toc_1a235fdbf16b92fac52940f351d8459ab3" kindref="member">set_properties</ref>(<ref refid="matrix__product__stl_8h_1afb69439b6c29dc85f40f2df36cf15d68" kindref="member">profile_matrix_product_dense</ref>,<sp/>5,</highlight><highlight class="stringliteral">&quot;Time<sp/>MultAx&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="85" refid="class_stl_matrix_product_1a6219be75e20d74386189487579c4b6c7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classclass__tic__toc" kindref="compound">class_tic_toc</ref><sp/><ref refid="class_stl_matrix_product_1a6219be75e20d74386189487579c4b6c7" kindref="member">t_factorOp</ref>;</highlight></codeline>
<codeline lineno="86" refid="class_stl_matrix_product_1af370a6db867ce36ca09b2953239b013b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classclass__tic__toc" kindref="compound">class_tic_toc</ref><sp/><ref refid="class_stl_matrix_product_1af370a6db867ce36ca09b2953239b013b" kindref="member">t_multOpv</ref>;</highlight></codeline>
<codeline lineno="87" refid="class_stl_matrix_product_1afd02aa86cc9ec8e94cffff6e33c659aa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classclass__tic__toc" kindref="compound">class_tic_toc</ref><sp/><ref refid="class_stl_matrix_product_1afd02aa86cc9ec8e94cffff6e33c659aa" kindref="member">t_multax</ref>;</highlight></codeline>
<codeline lineno="88"><highlight class="normal">};</highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="/home/david/Dropbox/PhD/Programming/DMRG++/DMRG++/source/math/arpack_extra/matrix_product_stl.h"/>
  </compounddef>
</doxygen>
